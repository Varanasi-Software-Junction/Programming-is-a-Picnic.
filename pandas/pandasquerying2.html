<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Pandas Querying Tutorial</title>
    <style>
        /* Basic styling */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f7fa;
        }

        header {
            background-color: #1e3a5f;
            color: white;
            padding: 20px;
            text-align: center;
        }

        h1, h2, h3 {
            color: #1e3a5f;
        }

        h2 {
            margin-top: 30px;
        }

        section {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        pre {
            background-color: #f0f8ff;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }

        .answer {
            display: none;
            margin-top: 10px;
        }

        .btn {
            background-color: #1e3a5f;
            color: white;
            padding: 10px 15px;
            border: none;
            cursor: pointer;
            border-radius: 3px;
        }

        .btn:hover {
            background-color: #163251;
        }

        footer {
            background-color: #1e3a5f;
            color: white;
            text-align: center;
            padding: 10px;
            position: fixed;
            bottom: 0;
            width: 100%;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            section {
                padding: 10px;
            }

            pre {
                font-size: 14px;
            }

            .btn {
                padding: 8px 12px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>

<header>
    <h1>Pandas Querying Tutorial</h1>
    <p>Learn how to use Pandas querying with examples, explanations, and assignments</p>
</header>

<section>
    <h2>Introduction to Pandas Querying</h2>
    <p>Pandas is a powerful data analysis library in Python. The <code>query()</code> function allows you to filter DataFrame rows based on conditions. It operates similarly to SQL queries and offers a cleaner and more efficient way to filter data.</p>

    <h3>Book Class Example</h3>
    <p>Letâ€™s start with an example of a <code>Book</code> class where we have a DataFrame with columns for book name, subject, and price.</p>

    <pre><code>import pandas as pd

# Sample DataFrame
data = {
    'bookname': ['Python Basics', 'Data Science with Python', 'Machine Learning', 
                 'Deep Learning', 'Artificial Intelligence'],
    'subject': ['Programming', 'Data Science', 'Machine Learning', 
                'Deep Learning', 'AI'],
    'price': [29.99, 39.99, 49.99, 59.99, 69.99]
}

books_df = pd.DataFrame(data)
print(books_df)</code></pre>

    <h3>1. Querying with AND, OR, NOT</h3>

    <h4>AND (`&`) Example</h4>
    <pre><code># Books with subject 'Machine Learning' AND price greater than 40
ml_expensive_books = books_df.query('subject == "Machine Learning" & price > 40')
print(ml_expensive_books)</code></pre>

    <h4>OR (`|`) Example</h4>
    <pre><code># Books with subject 'Data Science' OR price less than 30
ds_or_cheap_books = books_df.query('subject == "Data Science" | price < 30')
print(ds_or_cheap_books)</code></pre>

    <h4>NOT (`~`) Example</h4>
    <pre><code># Books where subject is NOT 'AI'
non_ai_books = books_df.query('subject != "AI"')
print(non_ai_books)</code></pre>

    <h3>2. Grouping Data</h3>
    <pre><code># Group by subject and calculate the average price
grouped_books = books_df.groupby('subject').agg({'price': 'mean'})
print(grouped_books)</code></pre>

    <h3>3. Ordering Data</h3>
    <pre><code># Sort books by price in ascending order
sorted_books = books_df.sort_values(by='price')
print(sorted_books)</code></pre>

    <h3>4. Subqueries</h3>
    <pre><code># Step 1: Filter books with price > 50
expensive_books = books_df.query('price > 50')

# Step 2: From the result, filter books that are related to 'AI'
ai_expensive_books = expensive_books.query('subject == "AI"')
print(ai_expensive_books)</code></pre>

    <h2>Assignments</h2>
    <p>Below are some query assignments for you to try. Click "Show Answer" to see the solutions.</p>

    <h4>Assignment 1: Query books with a price greater than 45 and subject is not 'Programming'.</h4>
    <button class="btn" onclick="toggleAnswer(1)">Show Answer</button>
    <pre id="answer1" class="answer"><code># Books with price > 45 and subject is not 'Programming'
result = books_df.query('price > 45 & subject != "Programming"')
print(result)</code></pre>

    <h4>Assignment 2: Query books with subject 'Deep Learning' or 'AI'.</h4>
    <button class="btn" onclick="toggleAnswer(2)">Show Answer</button>
    <pre id="answer2" class="answer"><code># Books with subject 'Deep Learning' OR 'AI'
result = books_df.query('subject == "Deep Learning" | subject == "AI"')
print(result)</code></pre>

    <h4>Assignment 3: Group books by subject and find the maximum price in each subject.</h4>
    <button class="btn" onclick="toggleAnswer(3)">Show Answer</button>
    <pre id="answer3" class="answer"><code># Group by subject and find the maximum price
result = books_df.groupby('subject').agg({'price': 'max'})
print(result)</code></pre>

    <h4>Assignment 4: Sort books by book name in descending order.</h4>
    <button class="btn" onclick="toggleAnswer(4)">Show Answer</button>
    <pre id="answer4" class="answer"><code># Sort books by bookname in descending order
result = books_df.sort_values(by='bookname', ascending=False)
print(result)</code></pre>

    <h4>Assignment 5: Query books with a price between 30 and 60, then group by subject and calculate the average price.</h4>
    <button class="btn" onclick="toggleAnswer(5)">Show Answer</button>
    <pre id="answer5" class="answer"><code># Query books with price between 30 and 60, group by subject and calculate average price
result = books_df.query('30 <= price <= 60').groupby('subject').agg({'price': 'mean'})
print(result)</code></pre>

</section>

<footer>
    
      <!-- ******************Branding ********************************** -->
      <div class='flip-container'>
        <div class='flipper'>
        <img alt='Me' class='flip-image' src='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglwaii2_xBr47JtUxESk3iekPLl1TSI5B6RuwqNOs_8zk9iGlLqw3d_WprAhKKp3m9F1eO4XBh_JfU_jj6Ad759bHWsqU0evz1SdsG_XBJPc7nXmkbGHO2glvshLTd0fOaKlIGfEVHlEeltJcg2Azc70rVoswRtvH-QiohpHrAuuPEE1uwA9CToBM9foE/s16000/me.jpg'/>
        </div>
        </div>
        <style>
        /* 3D Flipping Image Section */
        .flip-container {
            width: 80px;
            height: 80px;
            position: absolute;
            top: 50px;
            left: 50px;
            perspective: 1000px;
            animation: move-around 20s infinite linear;
        }
        
        .flip-container .flipper {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.8s;
            transform-style: preserve-3d;
        }
        
        .flip-container:hover .flipper {
            border-style: ridge;
        }
        
        .flip-image {
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 50%;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        /* Keyframe animation to move the image randomly */
        @keyframes move-around {
            0% { top: 20px; left: 20px; }
            25% { top: 50px; left: 80%; }
            50% { top: 80%; left: 50%; }
            75% { top: 50%; left: 20px; }
            100% { top: 20px; left: 20px; }
        }
        </style>
    
    
    
      <a href="https://wa.me/919335874326?text=Hi, I would like to get in touch!" target="_blank" class="whatsapp-button">
        <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp"
            class="whatsapp-icon">
        Contact Me on WhatsApp
    </a>
    <style>
        
    /* WhatsApp Button */
    .whatsapp-button {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 250px;
        padding: 12px;
        margin: 20px auto;
        background-color: #25D366;
        color: white;
        font-size: 16px;
        font-weight: bold;
        text-decoration: none;
        border-radius: 50px;
        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
        transition: background-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        cursor: pointer;
    }
    
    /* WhatsApp Icon */
    .whatsapp-icon {
        width: 24px;
        height: 24px;
        margin-right: 10px;
    }
    
    .whatsapp-button:hover {
        background-color: #128C7E;
        box-shadow: 0px 6px 12px rgba(0, 0, 0, 0.2);
    }
    
    
    </style>
    
    <!-- ******************Branding ********************************** -->

</footer>

<script>
    function toggleAnswer(id) {
        var answer = document.getElementById("answer" + id);
        if (answer.style.display === "none" || answer.style.display === "") {
            answer.style.display = "block";
        } else {
            answer.style.display = "none";
        }
    }
</script>

</body>
</html>
